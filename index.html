<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fastify Server Example</title>
</head>
<body>
    <script>
        const fastify = require("fastify")({ logger: true });

        fastify.register(require("@fastify/compress"), {
          encodings: ['br']
        });

        fastify.register(require("@fastify/static"), {
          root: join(__dirname, "../dist"),
          decorateReply: false
        });

        fastify.register(require("@fastify/static"), {
          root: uvPath,
          prefix: "/uv/",
          decorateReply: false
        });

        fastify.get("/search=:query", async (req, res) => {
          const { query } = req.params;

          try {
            const response = await fetch(
              `http://api.duckduckgo.com/ac?q=${query}&format=json`
            ).then((res) => res.json());
            res.send(response);
          } catch {
            res.code(500).send({ error: "Internal Server Error" });
          }
        });

        fastify.listen({ port: 8080 }, (err, address) => {
          if (err) {
            console.error(err);
            process.exit(1);
          }
          console.log(`Server listening at ${address}`);
        });
    </script>
</body>
</html>